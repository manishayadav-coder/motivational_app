<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Motivational App</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body class="bg">

<nav class="navbar">
  <a href="index.html">🏠 Home</a>
  <a href="feed.html">📢 Feed</a>
  <a href="#" id="postBtn">➕ Post</a>
  <a href="favourite.html">⭐ Favourites</a>
  <a href="profile.html">👤 Profile</a>
  <a href="login.html" onclick="logout()">🚪 Logout</a>
</nav>

<div class="container card" id="formContainer">
  <h1>🌟 Daily Motivational Quotes 🌟</h1>

  <label>Choose Language:</label>
  <select id="language">
    <option value="en">English</option>
    <option value="hi">Hindi</option>
  </select>

  <label>Choose Category:</label>
  <select id="category">
    <option value="sad">Sad Motivation</option>
    <option value="love">Love Motivation</option>
    <option value="attitude">Attitude Motivation</option>
    <option value="krishna">Krishna Motivation</option>
    <option value="geeta">Shrimad Bhagavad Gita Motivation</option>
    <option value="birthday">Birthday Quotes</option>
    <option value="anniversary">Anniversary Quotes</option>
    <option value="good_morning">Good Morning Quotes</option>
    <option value="good_evening">Good Evening Quotes</option>
    <option value="festival">Festival Quotes</option>
  </select>

  <label>Enter Your Name:</label>
  <input type="text" id="username" placeholder="Your name..."/>

  <label>Upload Image/Video:</label>
  <input type="file" id="imageUpload" name="file" accept="image/*,video/*"/>

  <button id="show-quote" class="btn-primary">Upload & Show Quotes</button>
</div>

<div class="container card" id="quoteSelection" style="display:none;">
  <h2>Select Your Favourite Quote</h2>
  <ul id="quoteList" class="quote-list"></ul>
</div>

<script>
  // 👇 Local backend के लिए (test)


  const API_BASE = "https://motivational-app-m9bi.onrender.com";


  function logout() {
    localStorage.clear();
    alert("You have been logged out!");
    window.location.href = "login.html";
  }

  // Show Quotes + Upload event
  document.getElementById("show-quote").addEventListener("click", async () => {
    let language = document.getElementById("language").value;
    const category = document.getElementById("category").value;
    const username = document.getElementById("username").value.trim();
    const file = document.getElementById("imageUpload").files[0];

    if (!username) {
      alert("⚠️ Please enter your name!");
      return;
    }
    if (!file) {
      alert("⚠️ Please upload an image or video!");
      return;
    }

    try {
      // 1️⃣ Upload file + name
      const formData = new FormData();
      formData.append("file", file);
      formData.append("name", username);
      formData.append("quote", "");

      const uploadRes = await fetch(`${API_BASE}/posts/upload`, {
        method: "POST",
        body: formData
      });
      const uploadData = await uploadRes.json();
      if (!uploadRes.ok || !uploadData.success) {
        throw new Error(uploadData.error || "Upload failed");
      }

      // 2️⃣ Fetch quotes
      const response = await fetch(
        `${API_BASE}/api/quotes?language=${language}&category=${category}`

      
      );
      if (!response.ok) throw new Error("Server error: " + response.statusText);

      const data = await response.json();
      const quotes = data.quotes || [];

      // 3️⃣ Show quotes list
      const quoteList = document.getElementById("quoteList");
      quoteList.innerHTML = "";
      quotes.forEach(q => {
        const li = document.createElement("li");
        li.textContent = q;
        quoteList.appendChild(li);
      });

      document.getElementById("formContainer").style.display = "none";
      document.getElementById("quoteSelection").style.display = "block";

    } catch (err) {
      console.error("Error:", err);
      alert("❌ Something went wrong: " + err.message);
    }
  });
</script>

</body>
</html>
